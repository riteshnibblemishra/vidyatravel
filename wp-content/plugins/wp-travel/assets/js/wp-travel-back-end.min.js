!function($){function wp_travel_filter_string(text){return text.toString().toLowerCase().replace(/\s+/g,"-").replace(/\,+/g,"-").replace(/\"+/g,"-").replace(/\'+/g,"-").replace(/\/+/g,"-").replace(/\(+/g,"-").replace(/\)+/g,"-").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function show_price_option_row(){var price_option_type=$("#wp-travel-pricing-option-type").val(),show_fields="."+price_option_type+"-option-row";$(".price-option-row").addClass("hidden"),$(show_fields).removeClass("hidden"),show_sale_price_field(),show_custom_payout_field()}function show_fixed_departured_date_row(){var price_option_type=$("#wp-travel-pricing-option-type").val(),fixed_departure=$("#wp-travel-fixed-departure");"multiple-price"!==price_option_type&&"single-price"!==price_option_type||(fixed_departure.is(":checked")?($(".wp-travel-fixed-departure-row").removeClass("hidden"),$(".wp-travel-trip-duration-row").addClass("hidden")):($(".wp-travel-fixed-departure-row").addClass("hidden"),$(".wp-travel-trip-duration-row").removeClass("hidden"))),$(".wp-travel-enable-multiple-dates").addClass("hidden"),"multiple-price"===price_option_type&&(fixed_departure.is(":checked")?($(".wp-travel-enable-multiple-dates, #wp-variations-multiple-dates").removeClass("hidden"),show_multiple_dates_fields()):$(".wp-travel-enable-multiple-dates, #wp-variations-multiple-dates").addClass("hidden"))}function show_multiple_dates_fields(){var price_option_type=$("#wp-travel-pricing-option-type").val(),enable_fixed_departure=$("#wp-travel-fixed-departure"),enable_multiple_fixed_departure=$("#wp-travel-enable-multiple-fixed-departure");"multiple-price"===price_option_type&&enable_fixed_departure.is(":checked")&&enable_multiple_fixed_departure.is(":checked")?($(".wp-travel-fixed-departure-row").addClass("hidden"),$("#wp-variations-multiple-dates").removeClass("hidden")):($(".wp-travel-fixed-departure-row").removeClass("hidden"),$("#wp-variations-multiple-dates").addClass("hidden"))}function show_sale_price_field(){"single-price"==$("#wp-travel-pricing-option-type").val()&&$("#wp-travel-enable-sale").is(":checked")?($("#wp-travel-sale-price").removeAttr("disabled").closest(".price-option-row").removeClass("hidden"),$("#wp-travel-price").attr("required","required"),$("#wp-travel-sale-price").attr("required","required")):($("#wp-travel-sale-price").attr("disabled","disabled").closest(".price-option-row").addClass("hidden"),$("#wp-travel-price").removeAttr("required"),$("#wp-travel-sale-price").removeAttr("required"))}function show_custom_payout_field(){$("#wp-travel-minimum-partial-payout-percent-use-global").is(":checked")?$("#wp-travel-minimum-partial-payout-percent").closest(".price-option-row").addClass("hidden"):$("#wp-travel-minimum-partial-payout-percent").closest(".price-option-row").removeClass("hidden")}function show_sale_price_field(){"single-price"==$("#wp-travel-pricing-option-type").val()&&$("#wp-travel-enable-sale").is(":checked")?($("#wp-travel-sale-price").removeAttr("disabled").closest(".price-option-row").removeClass("hidden"),$("#wp-travel-price").attr("required","required"),$("#wp-travel-sale-price").attr("required","required")):($("#wp-travel-sale-price").attr("disabled","disabled").closest(".price-option-row").addClass("hidden"),$("#wp-travel-price").removeAttr("required"),$("#wp-travel-sale-price").removeAttr("required"))}function show_minimum_payout_row(){$(".custom-payout-option-row").each(function(){$(this).hasClass("global-enabled")?$(this).removeClass("hidden"):$(this).addClass("hidden")})}if("undefined"!=typeof GMaps&&$("#gmap").length>0){var map=new GMaps({div:"#gmap",lat:wp_travel_drag_drop_uploader.lat,lng:wp_travel_drag_drop_uploader.lng}),input=document.getElementById("search-input"),autocomplete=new google.maps.places.Autocomplete(input);map.setCenter(wp_travel_drag_drop_uploader.lat,wp_travel_drag_drop_uploader.lng),map.setZoom(15),map.addMarker({lat:wp_travel_drag_drop_uploader.lat,lng:wp_travel_drag_drop_uploader.lng,title:wp_travel_drag_drop_uploader.loc,draggable:!0,dragend:function(e){var lat=e.latLng.lat(),lng=e.latLng.lng();map.setCenter(lat,lng);var latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&($("#wp-travel-lat").val(lat),$("#wp-travel-lng").val(lng),$("#wp-travel-location").val(results[1].formatted_address),$("#search-input").val(results[1].formatted_address))})}}),autocomplete.bindTo("bounds",map),autocomplete.addListener("place_changed",function(){var place=autocomplete.getPlace();if(!place.geometry)return void window.alert("Autocomplete's returned place contains no geometry");map.removeMarkers(),place.geometry.viewport?map.fitBounds(place.geometry.viewport):(map.setCenter(place.geometry.location),map.setZoom(15));var lat=place.geometry.location.lat(),lng=place.geometry.location.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&($("#wp-travel-lat").val(lat),$("#wp-travel-lng").val(lng),$("#wp-travel-location").val(results[1].formatted_address),$("#search-input").val(results[1].formatted_address))}),map.addMarker({lat:lat,lng:lng,title:place.formatted_address,draggable:!0,dragend:function(e){var lat=e.latLng.lat(),lng=e.latLng.lng();map.setCenter(lat,lng);var latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&($("#wp-travel-lat").val(lat),$("#wp-travel-lng").val(lng),$("#wp-travel-location").val(results[1].formatted_address),$("#search-input").val(results[1].formatted_address))})}})})}$.fn.tabs&&$(".wp-travel-tabs-wrap").tabs({activate:function(event,ui){$(ui.newPanel).css({display:"inline-block"}),$("#wp-travel-settings-current-tab").val($(ui.newPanel).attr("id")),"undefined"!=typeof GMaps&&$("#gmap").length>0&&(map.refresh(),google.maps.event.trigger(map.map,"resize"))},create:function(event,ui){$(ui.panel).css({display:"inline-block"}),$("#wp-travel-settings-current-tab").val($(ui.panel).attr("id"))},load:function(event,ui){}}),function(){$.fn.wpt_datepicker&&($("#wp-travel-start-date").wpt_datepicker({language:"en",minDate:new Date,onSelect:function(dateStr){newMinDate=null,newMaxDate=new Date,""!==dateStr&&(milliseconds=moment(dateStr,"YYYY-MM-DD"),new_date_min=new Date(milliseconds),newMinDate=new Date(new_date_min.setDate(new Date(new_date_min.getDate())))),$("#wp-travel-end-date").wpt_datepicker({minDate:newMinDate})}}),$("#wp-travel-end-date").wpt_datepicker({language:"en",minDate:new Date}),$(".wp-travel-datepicker").wpt_datepicker({language:"en",minDate:new Date}),$(".wp-travel-timepicker").wpt_datepicker({language:"en",timepicker:!0,onlyTimepicker:!0}))}(),$(document).on("click","#publish",function(){var start_date=$("#wp-travel-start-date").val(),end_date=$("#wp-travel-end-date").val(),error="";if(""==start_date&&""==end_date||""==start_date&&(error+="Start date can't be empty!\n"),""!=error)return alert(error),!1;$(document).off("click","#publish")});$(document).on("click","#wp-travel-enable-sale",function(){show_sale_price_field()}),$(document).on("change","#wp-travel-pricing-option-type",function(){show_price_option_row(),show_fixed_departured_date_row(),show_minimum_payout_row()}),$(document).on("click","#wp-travel-fixed-departure",function(){show_fixed_departured_date_row()}),$(document).on("change","#wp-travel-enable-multiple-fixed-departure",function(){show_multiple_dates_fields()}),show_price_option_row(),show_fixed_departured_date_row(),show_minimum_payout_row(),$(document).on("click",".wp-travel-clone-post",function(e){e.preventDefault();var post_id=$(this).data("post_id"),security=$(this).data("security"),data={post_id:post_id,security:security,action:"wp_travel_clone_trip"};$.ajax({url:ajaxurl,data:data,type:"post",dataType:"json",success:function(data){location.href=location.href}})}),$(document).on("change",".wp-travel-variation-pricing-name",function(){var price_key=wp_travel_filter_string($(this).val());$(this).siblings(".wp-travel-variation-pricing-uniquekey").val(price_key)}),$(document).on("change",".wp-travel-pricing-options-list",function(){var category_id=$(this).data("category-id");"custom"===$(this).val()?$(".custom-pricing-label-wrap-"+category_id).css("display","block"):$(".custom-pricing-label-wrap-"+category_id).css("display","none")}),$(".wp-travel-pricing-options-list").trigger("change"),$(document).on("change",".wp-travel-enable-variation-price-sale",function(){var siblings=$(this).closest(".repeat-row").next(".repeat-row");$(this).is(":checked")?(siblings.removeClass("hidden"),siblings.find('input[type="number"]').attr("required","required")):(siblings.addClass("hidden"),siblings.find('input[type="number"]').removeAttr("required"))}),$(".wp-travel-enable-variation-price-sale").is(":checked")?$(this).closest(".repeat-row").next(".repeat-row").removeClass("hidden"):$(this).closest(".repeat-row").next(".repeat-row").addClass("hidden"),$(document).on("change",".wp-travel-enable-variation-price-sale-new",function(){var siblings=$(this).closest(".repeat-row").next(".repeat-row");$(this).is(":checked")?(siblings.removeClass("visibility-hidden"),siblings.find('input[type="number"]').attr("required","required")):(siblings.addClass("visibility-hidden"),siblings.find('input[type="number"]').removeAttr("required"))}),$(".wp-travel-enable-variation-price-sale-new").is(":checked")?$(this).closest(".repeat-row").next(".repeat-row").removeClass("visibility-hidden"):$(this).closest(".repeat-row").next(".repeat-row").addClass("visibility-hidden"),$("#wp-travel-enable-sale").is(":checked")&&($("#wp-travel-price").attr("required","required"),$("#wp-travel-sale-price").attr("required","required")),$(document).on("click",".wp-travel-featured-post",function(e){e.preventDefault();var featuredIcon=$(this),post_id=$(this).attr("data-post-id"),nonce=$(this).attr("data-nonce"),data={action:"wp_travel_featured_post",post_id:post_id,nonce:nonce};$.ajax({url:ajaxurl,data:data,type:"post",dataType:"json",success:function(data){"invalid"!=data&&(featuredIcon.removeClass("dashicons-star-filled").removeClass("dashicons-star-empty"),"yes"==data.new_status?featuredIcon.addClass("dashicons-star-filled"):featuredIcon.addClass("dashicons-star-empty"))}})}),$("#add_itinerary_row").click(function(e){e.preventDefault();var template=wp.template("wp-travel-itinerary-items"),rand=Math.floor(990*Math.random())+10;$(".itinerary_block").append(template({random:rand})),$(".itinerary_block .panel:last .wp-travel-datepicker").wpt_datepicker({language:"en",minDate:new Date}),$(".itinerary_block .panel:last .wp-travel-timepicker").wpt_datepicker({language:"en",timepicker:!0,onlyTimepicker:!0}),$(".while-empty").addClass("hidden"),$(".wp-collapse-open").removeClass("hidden")}),$(document).on("click",".remove_itinery",function(e){return e.preventDefault(),$(this).closest(".itinerary_wrap").remove(),!1});$(".tab-accordion .wp-travel-sorting-tabs, #tab-accordion .wp-travel-sorting-tabs, #tab-accordion-itineraries #accordion-itinerary-data").sortable({handle:".wp-travel-sorting-handle"}),$("#wp-travel-tab-content-setting .wp-travel-sorting-tabs tbody").sortable({handle:".wp-travel-sorting-handle"}),$.ui.accordion.prototype._originalKeyDown=$.ui.accordion.prototype._keydown,$.ui.accordion.prototype._keydown=function(event){var keyCode=$.ui.keyCode;event.keyCode!=keyCode.SPACE&&this._originalKeyDown(event)},$(".ui-accordion-header").click(function(){$(".open-all-link").removeClass("hidden"),$(".close-all-link").removeClass("hidden")}),$(document).on("click",".wt-accordion-close",function(e){var acc_id=$(this).closest(".tab-accordion").attr("id");if(1==confirm("Are you sure you want to delete?")){$(this).closest("div.panel-default").remove();$("#"+acc_id+" .panel-default:visible").length>0?($(".while-empty").addClass("hidden").hide(),$(".wp-collapse-open").removeClass("hidden").show()):($(".wp-collapse-open").addClass("hidden").hide(),$(".while-empty").removeClass("hidden").show())}}),$(".wp-travel-faq-add-new").on("click",function(){var template=wp.template("wp-travel-faq"),rand=($("#accordion-faq-data panel-default").length,Math.floor(990*Math.random())+10);$("#accordion-faq-data").append(template({random:rand})),$(".while-empty").addClass("hidden"),$(".wp-collapse-open").removeClass("hidden")}),$(".wp-travel-pricing-add-new").on("click",function(){var template=wp.template("wp-travel-pricing-options"),rand=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),category_id=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);$("#pricing-options-data").append(template({random:rand,category_id:category_id}))}),$(".wp-travel-trip-facts-add-new").on("click",function(){var template=wp.template("wp-travel-trip-facts-options"),rand=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);$("#accordion-fact-data").append(template({random:rand}))}),$("#date-options-data .panel .wp-travel-multiple-start-date").each(function(){var th=$(this),savedMeanDate=$(this).val();newMinDate=new Date,""!==savedMeanDate&&(milliseconds=moment(savedMeanDate,"YYYY-MM-DD"),new_date_min=new Date(milliseconds),newMinDate=new Date(new_date_min.setDate(new Date(new_date_min.getDate()))),$(this).siblings(".wp-travel-multiple-end-date").wpt_datepicker({minDate:newMinDate})),$(this).wpt_datepicker({language:"en",minDate:new Date,onSelect:function(dateStr){newMinDate=null,newMaxDate=new Date,""!==dateStr&&(milliseconds=moment(dateStr,"YYYY-MM-DD"),new_date_min=new Date(milliseconds),newMinDate=new Date(new_date_min.setDate(new Date(new_date_min.getDate())))),th.siblings(".wp-travel-multiple-end-date").wpt_datepicker({minDate:newMinDate})}})}),$(".wp-travel-multiple-dates-add-new").on("click",function(){var template=wp.template("wp-travel-multiple-dates"),rand=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);$("#date-options-data").append(template({random:rand})),$("#date-options-data .panel:last .wp-travel-multiple-start-date").wpt_datepicker({language:"en",minDate:new Date,onSelect:function(dateStr){newMinDate=null,newMaxDate=new Date,""!==dateStr&&(milliseconds=moment(dateStr,"YYYY-MM-DD"),new_date_min=new Date(milliseconds),newMinDate=new Date(new_date_min.setDate(new Date(new_date_min.getDate())))),$("#date-options-data .panel:last .wp-travel-multiple-end-date").wpt_datepicker({minDate:newMinDate})}})}),$(document).on("change keyup","*[bind]",function(e){var to_bind=$(this).attr("bind"),value=""!=$(this).val()?$(this).val():"Untitled";$("*[bind='"+to_bind+"']").html(value),$("*[bind='"+to_bind+"']").val($(this).val())}),$(document).on("change keyup","*[bindPrice]",function(e){var bound_sale=$(this).attr("bindPrice"),value=""!=$(this).val()?$(this).val():1;$("*[bindSale='"+bound_sale+"']").attr("max",value)}),$(document).on("keyup change",".section_title",function(){var title=$(this).val();$(this).siblings(".wp-travel-accordion-title").html(title)}),$(document).on("keyup change","#wp-travel-price",function(){var priceVal=$(this).val();$("#wp-travel-sale-price").attr("max",priceVal)}),$(document).on("keyup change",".pricing-opt-min-pax",function(){var priceVal=$(this).val();$(this).siblings(".pricing-opt-max-pax").attr("min",priceVal)}),$("#wp-travel-use-global-tabs").is(":checked")?$("#wp-travel-tab-content-tabs .wp-travel-sorting-tabs").css({opacity:"0.3","pointer-events":"none"}):$("#wp-travel-tab-content-tabs .wp-travel-sorting-tabs").css({opacity:"1","pointer-events":"auto"}),$("#wp-travel-use-global-tabs").change(function(){$(this).is(":checked")?$("#wp-travel-tab-content-tabs .wp-travel-sorting-tabs").css({opacity:"0.3","pointer-events":"none"}):$("#wp-travel-tab-content-tabs .wp-travel-sorting-tabs").css({opacity:"1","pointer-events":"auto"})}),$("#wp-travel-use-global-trip-enquiry").is(":checked")?$("#wp-travel-enable-trip-enquiry-option-row").addClass("hidden"):$("#wp-travel-enable-trip-enquiry-option-row").removeClass("hidden"),$("#wp-travel-use-global-trip-enquiry").change(function(){$(this).is(":checked")?$("#wp-travel-enable-trip-enquiry-option-row").addClass("hidden"):$("#wp-travel-enable-trip-enquiry-option-row").removeClass("hidden")}),$(document).on("click","#wp-travel-enable-sale",function(){$("#wp-travel-price").val();$(this).is(":checked")&&$("#wp-travel-sale-price").val()}),$(document).on("change","#wp-travel-sale-price",function(){$(this).val()}),$(document).on("click","#wp-travel-minimum-partial-payout-percent-use-global",function(){show_custom_payout_field()}),$('input[type="number"]').on("change",function(){if("Min PAX"==$(this).attr("placeholder")){var minPax=$(this).val();$(this).siblings('input[type="number').attr("min",minPax)}}),jQuery(".select-main .close").addClass("hidden"),jQuery(document).on("click",".select-main .close",function(){$(this).siblings(".wp-travel-active").removeClass("wp-travel-active"),$(this).siblings(".carret").removeClass("hidden"),$(this).addClass("hidden")}),jQuery(document).on("click",".select-main, .select-main .caret",function(e){0==$(this).find("ul.wp-travel-active").length?($(this).children("ul").addClass("wp-travel-active"),$(this).children(".close").removeClass("hidden"),$(this).children(".carret").addClass("hidden")):($(this).children(".carret").removeClass("hidden"),$(this).children(".close").addClass("hidden"),$(this).children("ul").removeClass("wp-travel-active"))}),$(document).on("click",function(event){var $trigger=$(".select-main");$trigger===event.target||$trigger.has(event.target).length||($("ul.wp-travel-active").removeClass("wp-travel-active"),$(".select-main").children(".carret").removeClass("hidden"),$(".select-main").children(".close").addClass("hidden"))}),jQuery(document).on("change",".select-main li input.multiselect-value",function($){var total_inputs_length=jQuery(this).closest(".select-main").find("li input.multiselect-value").length;jQuery(this).closest(".select-main").find("li input.multiselect-value:checked").length==total_inputs_length?jQuery(this).closest(".select-main").find(".multiselect-all").prop("checked",!0):jQuery(this).closest(".select-main").find(".multiselect-all").prop("checked",!1),jQuery(this).closest("li").toggleClass("selected")}),jQuery(document).on("change",".multiselect-all",function($){jQuery(this).is(":checked")?jQuery(this).closest("li").siblings().addClass("selected").find("input.multiselect-value").prop("checked",!0):jQuery(this).closest("li").siblings().removeClass("selected").find("input.multiselect-value").prop("checked",!1)});var updateTable=function(event){var countSelected=(jQuery(this).attr("id"),jQuery(this).closest(".select-main").find("li.selected").length);jQuery(this).closest(".select-main").find("ul").siblings(".selected-item").html(countSelected+" item selected")};jQuery(document).on("input click change","input.wp-travel-multi-inner",updateTable),jQuery(document).on("click",".fact-deleter",function(){jQuery(this).parent().parent().parent().remove()});const types={multiple:function(obj,unique){val=this.val(),index=this.data("index"),jQuery(".fact-"+index).html((obj.options||[]).map(function(option){return jQuery('<label><input type="checkbox" name="wp_travel_trip_facts['+unique+'][value][]" value="'+option+'"  >'+option+"</label>")}))},single:function(obj,unique){val=this.val(),index=this.data("index"),jQuery(".fact-"+index).html(jQuery("<select>").attr("name","wp_travel_trip_facts["+unique+"][value]").html((obj.options||[]).map(function(option){return jQuery("<option>").attr("value",option).html(option)})))},text:function(obj,unique){val=this.val(),index=this.data("index"),jQuery(".fact-"+index).html(jQuery('<input type="text">').attr("name","wp_travel_trip_facts["+unique+"][value]"))},default:function(obj,unique){val=this.val(),index=this.data("index"),jQuery(".icon-"+index).attr("name","wp_travel_trip_facts["+unique+"][icon]").val(obj.icon),jQuery(".type-"+index).attr("name","wp_travel_trip_facts["+unique+"][type]").val(obj.type)}};jQuery(document).on("change",".fact-type-selecter",function(){const unique=Math.random().toString(36).substr(2,9);jQuery(this).attr("name","wp_travel_trip_facts["+unique+"][label]");const val=jQuery(this).val();var settings=jQuery("#accordion-fact-data").data("factssettings");const setting=settings.filter(function(setting){return val==setting.name})[0];settings.filter(function(setting){return val==setting.type})[0];setting&&(types[setting.type].call(jQuery(this),setting,unique),types.default.call(jQuery(this),setting,unique))})}(jQuery);
